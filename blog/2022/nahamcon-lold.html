<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/all.min.css">
    <meta name="twitter:image" content="https://compromyse.xyz/assets/img/author.png">
    <meta property="og:image" content="https://compromyse.xyz/assets/img/author.png">
    <meta name="description" content="Hi there! I'm Raghuram Subramani. I love learning new techniques and programming languages. Outside of programming, I enjoy playing Soccer, Badminton and TableTennis.">
    <meta property="og:description" content="Hi there! I'm Raghuram Subramani. I love learning new techniques and programming languages. Outside of programming, I enjoy playing Soccer, Badminton and TableTennis.">
    <meta name="twitter:description" content="Hi there! I'm Raghuram Subramani. I love learning new techniques and programming languages. Outside of programming, I enjoy playing Soccer, Badminton and TableTennis.">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NahamCon CTF 2022 &gt; LOLD | c0mpr0mys3</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="NahamCon CTF 2022 &gt; LOLD" />
<meta name="author" content="c0mpr0mys3" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Writeup For The LOLD Challenge In NahamCon CTF 2022" />
<meta property="og:description" content="Writeup For The LOLD Challenge In NahamCon CTF 2022" />
<link rel="canonical" href="/blog/2022/nahamcon-lold" />
<meta property="og:url" content="/blog/2022/nahamcon-lold" />
<meta property="og:site_name" content="c0mpr0mys3" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-01T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NahamCon CTF 2022 &gt; LOLD" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"c0mpr0mys3"},"dateModified":"2022-05-01T00:00:00+05:30","datePublished":"2022-05-01T00:00:00+05:30","description":"Writeup For The LOLD Challenge In NahamCon CTF 2022","headline":"NahamCon CTF 2022 &gt; LOLD","mainEntityOfPage":{"@type":"WebPage","@id":"/blog/2022/nahamcon-lold"},"url":"/blog/2022/nahamcon-lold"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <script>
    function openNav() {
    document.getElementById("mySidenav").style.width = "250px";
  }

  function closeNav() {
    document.getElementById("mySidenav").style.width = "0";
  }
  </script>
  <body style="background-color: #0f0f12;">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <div class = flex><nav class="bg-background navbar hidden 
            relative md:flex w-full flex-row items-center 
            justify-start py-4 text-gray-500 shadow-lg">
    
    <div class="ml-2 flex flex-grow flex-row">
      <a href="/" class="ml-2 rounded font-mono text-xl
      text-white transition-all px-2 pt-1 pb-0
      hover:bg-gray-800">~/compromyse</a>
  
      <a href="/blog" class="ml-3 rounded font-mono px-2
      transition-all pt-1 pb-0
      hover:bg-gray-800">/dev/blog</a>
  
      <a href="/about" class="ml-3 rounded font-mono px-2
      transition-all hover:bg-gray-800 pt-1 pb-0">/usr/about</a>
  
      <a href="/ctf" class="ml-3 rounded font-mono px-2
      transition-all hover:bg-gray-800 pt-1 pb-0">/bin/ctf</a>
  
      <i class="fa fa-search ml-auto mr-5 rounded hover:bg-gray-800
                px-2 pt-2" style="cursor: pointer;" onclick="openSearch();"></i>
    </div>
</nav>

<div id="myOverlay" class="overlay">
  <div class="relative flex flex-col top-1/4 w-4/5
              mt-8 m-auto">
      <input type="text" id="search-input" placeholder="Search.." name="search"
        class="search-bar">
    <ul id="results-container" class="text-white text-xl overflow-auto
                                      pb-4 h-96"></ul>
  </div>
</div>

<script>
// Open the full screen search box
function openSearch() {
  document.getElementById("myOverlay").style.display = "block";
}

// Close the full screen search box
function closeSearch() {
  document.getElementById("myOverlay").style.display = "none";
}

function openNav() {
  document.getElementById("mySidenav").style.width = "250px";
}

function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
}
</script>

<script src="/assets/js/search-script.js" type="text/javascript"></script>

<script>
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json'
  })

  document.addEventListener('keyup', function(event) {
    if ( event.keyCode == 27 ) {
      closeSearch()
    }
  })
</script>

<style>
body {
  font-family: "Lato", sans-serif;
}

.sidenav {
  height: 100%;
  width: 0;
  position: fixed;
  z-index: 1;
  top: 0;
  right: 0;
  background-color: #0f0e12;
  overflow-x: hidden;
  transition: 0.5s;
  padding-top: 60px;
}

.sidenav a {
  padding: 8px 8px 8px 32px;
  text-decoration: none;
  font-size: 25px;
  color: #818181;
  display: block;
  transition: 0.3s;
}

.sidenav .closebtn {
  position: absolute;
  top: 0;
  right: 25px;
  font-size: 36px;
  margin-left: 50px;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 18px;}
}
</style>

<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="/blog">Blog</a>
  <a href="/about">About</a>
  <a href="/ctf">CTF</a>
</div>

<nav class="bg-background navbar md:hidden flex 
            relative w-full flex-row items-center 
            justify-start py-4 text-gray-500 shadow-lg">
    
    <div class="ml-2 flex flex-grow flex-row">
      <a href="/" class="ml-2 rounded font-mono text-xl
      text-white transition-all px-2 pt-1 pb-0
      hover:bg-gray-700">~/compromyse</a>
  
    <button class="fa fa-bars mr-5 rounded ml-auto
                        px-2 pt-2" style="cursor: pointer;" onclick="openNav()"></button>
    </div>
</nav></div>
    <div class="mb-12">
    <div class="pb-10">
  <div class="text-3xl text-white font-mono text-center pt-7">
    NahamCon CTF 2022 > LOLD
  </div>
  <div class="text-lg text-white font-mono text-center pt-3">
    Writeup For The LOLD Challenge In NahamCon CTF 2022
  </div>
  <div class="font-mono text-center pt-2">
  
    <a class="text-gray-400">writeup</a>
  
  </div>
  <div class="text-xl text-white font-mono text-center">
  <a class="text-datesearch text-sm">1 May 2022 	&#9679; 12 min read</a>
  </div>
</div>

<div class="prose md:prose-lg lg:prose-xl prose-invert mx-auto items-center prose-pink pb-12">
  <h3 id="introduction">Introduction</h3>

<p>“LOLD” is a challenge in NahamCon CTF that took place from the 28th of April to the 30th of April.</p>

<h3 id="challenge">Challenge</h3>

<p><code class="language-plaintext highlighter-rouge">HAI!!!! WE HAZ THE BESTEST LOLPYTHON INTERPRETERERERER U HAS EVER SEEEEEN! YOU GIVE SCRIPT, WE RUN SCRIPT!! AND FLAG IS EVEN AT /flag.txt.</code></p>

<p>From this challenge description, we can see that the flag is at <code class="language-plaintext highlighter-rouge">/flag.txt</code> and it’s a LOLPython Interpreter running on the challenge host.</p>

<h3 id="lolpython-what">LOLPython, What..?</h3>

<p>Searching for “LOLPython” in your favorite search engine reveals <a href="http://www.dalkescientific.com/writings/diary/archive/2007/06/01/lolpython.html">this</a> webpage. “LOLPython is a Python macro”. LOLPython was written using python<strong>2</strong>, it’s old don’t judge him.</p>

<p>A hello world in LOLPython would be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">VISIBLE</span> <span class="s">'hello world'</span>
</code></pre></div></div>

<p>And the python2 equivalent would be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="s">'hello world'</span>
</code></pre></div></div>

<p>In the challenge <code class="language-plaintext highlighter-rouge">Attachments</code> There is a <code class="language-plaintext highlighter-rouge">lolpython.py</code> file which does the conversion and execution. To run <code class="language-plaintext highlighter-rouge">lolpython.py</code> you need python2 and python2 pip. Install them and run <code class="language-plaintext highlighter-rouge">python2 -m pip install ply</code>.</p>

<p>To run the <code class="language-plaintext highlighter-rouge">hello world</code> in LOLPython do</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"VISIBLE 'hello world'"</span> | python2 lolpython.py
</code></pre></div></div>

<p>To see the converted code in python2, do</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"VISIBLE 'hello world'"</span> | python2 lolpython.py <span class="nt">--convert</span>
</code></pre></div></div>

<p>This is very useful for debugging.</p>

<p>Now rather than doing <code class="language-plaintext highlighter-rouge">echo command | python2 lolpython.py</code>, we can make a <code class="language-plaintext highlighter-rouge">solve.py</code> that prints the commands.</p>

<p>An example would be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"""
VISIBLE 'hello world'
VISIBLE 'second command'
"""</span><span class="p">)</span>
</code></pre></div></div>

<p>So to run the script we would do <code class="language-plaintext highlighter-rouge">python3 solve.py | python2 lolpython.py</code> This pipes the output of <code class="language-plaintext highlighter-rouge">solve.py</code> to <code class="language-plaintext highlighter-rouge">lolpython.py</code>.</p>

<h3 id="the-plan">The Plan</h3>

<p>So we know the flag is at <code class="language-plaintext highlighter-rouge">/flag.txt</code> and we need some way to read it. Python has a module named <code class="language-plaintext highlighter-rouge">os</code> which can run commands on the system. The code to read <code class="language-plaintext highlighter-rouge">/flag.txt</code> in python2 would be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'cat /flag.txt'</span><span class="p">)</span>
</code></pre></div></div>

<p>Here, <code class="language-plaintext highlighter-rouge">os</code> is the module and <code class="language-plaintext highlighter-rouge">os.system('command')</code> executes the command that’s passed to it. Here the command is <code class="language-plaintext highlighter-rouge">cat /flag.txt</code>. <code class="language-plaintext highlighter-rouge">cat</code>, in Linux prints the content of the file that’s passed to it, in this case <code class="language-plaintext highlighter-rouge">/flag.txt</code>.</p>

<h3 id="exploitation">Exploitation</h3>

<p>We first need to find a way to execute the script on the remote host. We can do the same thing we did before, replacing <code class="language-plaintext highlighter-rouge">python2 lolpython.py</code> with <code class="language-plaintext highlighter-rouge">nc host port</code> so <code class="language-plaintext highlighter-rouge">python3 solve.py | nc host port</code></p>

<p>Now we need to find a way to convert the python2 code to LOLPython code. Looking at the examples from the website, we can see that <code class="language-plaintext highlighter-rouge">IN MAI library GIMME module</code> imports the module from the library. So in this case we would need <code class="language-plaintext highlighter-rouge">IN MAI os GIMME system</code> which would <code class="language-plaintext highlighter-rouge">import system from os</code>.</p>

<p>Looking at the examples, we do <code class="language-plaintext highlighter-rouge">function WIT 'argument'!</code> to run a function command. In this case, <code class="language-plaintext highlighter-rouge">system WIT 'cat /flag.txt'!</code> will be equal to <code class="language-plaintext highlighter-rouge">system('cat /flag.txt')</code>.</p>

<p>Putting all of this together, the final solve.py script would be</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"""
IN MAI os GIMME system
system WIT 'cat /flag.txt'!
"""</span><span class="p">)</span>
</code></pre></div></div>

<p>Running <code class="language-plaintext highlighter-rouge">python3 solve.py | nc host port</code> will result in the host printing the flag.</p>

<h4 id="thank-you-for-reading">Thank you for reading!</h4>

</div>
    </div><footer class="absolute bottom-0 w-full h-auto p-4 shadow 
    flex items-center justify-center md:p-6 bg-background
    overflow-hidden left-0 pt-3">
    <span class="text-gray-500 text-center font-mono">
        The Quieter You Become, The More You Are Able To Hear.
    </span>
</footer></body>
</html>
